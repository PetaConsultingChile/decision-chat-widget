<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Widget de Chat Din√°mico - Demo</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        
        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 30px;
        }
        
        .demo-section {
            margin-bottom: 30px;
            padding: 20px;
            border: 1px solid #e0e0e0;
            border-radius: 10px;
            background: #f9f9f9;
        }
        
        .demo-section h3 {
            color: #555;
            margin-top: 0;
        }
        
        button {
            background: #336090;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
            font-size: 14px;
        }
        
        button:hover {
            background: #2a4f7a;
        }
        
        .code-block {
            background: #f4f4f4;
            padding: 15px;
            border-radius: 5px;
            font-family: monospace;
            font-size: 12px;
            overflow-x: auto;
            margin: 10px 0;
        }
        
        .status {
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
            font-weight: bold;
        }
        
        .status.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .status.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üöÄ Widget de Chat Din√°mico - Demo</h1>
        
        <div class="demo-section">
            <h3>üìã Configuraci√≥n B√°sica</h3>
            <p>El widget se carga autom√°ticamente. Puedes configurarlo de varias maneras:</p>
            
            <h4>1. Configuraci√≥n desde HTML (atributos data-*)</h4>
            <div class="code-block">
&lt;script src="widget.js" 
        data-api-url="https://api.ejemplo.com/decision-tree" 
        data-update-interval="30000"&gt;&lt;/script&gt;
            </div>
            
            <h4>2. Configuraci√≥n desde JavaScript</h4>
            <div class="code-block">
window.decisionChatConfig = {
  apiUrl: 'https://api.ejemplo.com/decision-tree',
  updateInterval: 30000,
  initialTree: { /* tu √°rbol personalizado */ }
};
            </div>
        </div>
        
        <div class="demo-section">
            <h3>üéÆ Controles Din√°micos</h3>
            <p>Usa estos botones para probar las funciones din√°micas:</p>
            
            <button onclick="addNewNode()">‚ûï Agregar Nodo</button>
            <button onclick="updateNodeOptions()">üîÑ Actualizar Opciones</button>
            <button onclick="addCustomAction()">‚ö° Agregar Acci√≥n</button>
            <button onclick="loadFromAPI()">üåê Cargar desde API</button>
            <button onclick="showCurrentTree()">üëÅÔ∏è Ver √Årbol Actual</button>
            <button onclick="resetToDefault()">üîÑ Resetear a Default</button>
        </div>
        
        <div class="demo-section">
            <h3>üìä Estado del Widget</h3>
            <div id="status"></div>
        </div>
        
        <div class="demo-section">
            <h3>üîß API del Widget</h3>
            <p>Funciones disponibles en <code>window.decisionChatWidget</code>:</p>
            <ul>
                <li><code>updateTree(newTree)</code> - Actualiza todo el √°rbol</li>
                <li><code>getTree()</code> - Obtiene el √°rbol actual</li>
                <li><code>addNode(nodeId, nodeData)</code> - Agrega un nodo</li>
                <li><code>removeNode(nodeId)</code> - Remueve un nodo</li>
                <li><code>updateNodeOptions(nodeId, newOptions)</code> - Actualiza opciones de un nodo</li>
                <li><code>updateActions(newActions)</code> - Actualiza acciones</li>
                <li><code>reloadFromAPI()</code> - Recarga desde API</li>
            </ul>
        </div>
    </div>

    <!-- Widget Script -->
    <script src="widget.js"></script>
    
    <script>
        // Configuraci√≥n de ejemplo
        window.decisionChatConfig = {
            updateInterval: 0, // Sin actualizaci√≥n autom√°tica para el demo
            initialTree: {
                start: {
                    message: "¬°Hola! Este es un demo del widget din√°mico. ¬øQu√© quieres hacer?",
                    options: [
                        { text: "Ver funciones din√°micas", next: "dynamic_demo" },
                        { text: "Probar acciones personalizadas", next: "custom_actions" },
                        { text: "Volver al √°rbol original", next: "original_tree" }
                    ]
                },
                dynamic_demo: {
                    message: "¬°Excelente! Aqu√≠ puedes ver c√≥mo las opciones se actualizan din√°micamente.",
                    options: [
                        { text: "Agregar nueva opci√≥n", action: "add_option_demo" },
                        { text: "Cambiar mensaje", action: "change_message_demo" },
                        { text: "Volver al inicio", next: "start" }
                    ]
                },
                custom_actions: {
                    message: "Estas acciones se pueden personalizar completamente.",
                    options: [
                        { text: "Abrir Google", action: "open_google" },
                        { text: "Mostrar alerta personalizada", action: "custom_alert" },
                        { text: "Volver al inicio", next: "start" }
                    ]
                },
                original_tree: {
                    message: "Volviendo al √°rbol original del taller...",
                    options: [
                        { text: "Continuar", next: "start" }
                    ]
                }
            }
        };

        // Funciones de demostraci√≥n
        function addNewNode() {
            const success = window.decisionChatWidget.addNode('nuevo_nodo', {
                message: "¬°Este es un nodo agregado din√°micamente!",
                options: [
                    { text: "Opci√≥n 1", action: "demo_action_1" },
                    { text: "Opci√≥n 2", action: "demo_action_2" },
                    { text: "Volver al inicio", next: "start" }
                ]
            });
            
            showStatus(success ? "‚úÖ Nodo agregado exitosamente" : "‚ùå Error al agregar nodo");
        }

        function updateNodeOptions() {
            const newOptions = [
                { text: "Opci√≥n actualizada 1", action: "updated_action_1" },
                { text: "Opci√≥n actualizada 2", action: "updated_action_2" },
                { text: "Opci√≥n actualizada 3", next: "start" }
            ];
            
            const success = window.decisionChatWidget.updateNodeOptions('start', newOptions);
            showStatus(success ? "‚úÖ Opciones actualizadas" : "‚ùå Error al actualizar opciones");
        }

        function addCustomAction() {
            const newActions = {
                add_option_demo: () => {
                    alert("¬°Esta acci√≥n fue agregada din√°micamente!");
                    window.decisionChatWidget.updateNodeOptions('dynamic_demo', [
                        { text: "¬°Nueva opci√≥n agregada!", action: "new_action" },
                        { text: "Volver al inicio", next: "start" }
                    ]);
                },
                change_message_demo: () => {
                    window.decisionChatWidget.updateTree({
                        dynamic_demo: {
                            message: "¬°El mensaje fue cambiado din√°micamente!",
                            options: [
                                { text: "¬°Incre√≠ble!", action: "amazing_action" },
                                { text: "Volver al inicio", next: "start" }
                            ]
                        }
                    });
                },
                open_google: () => window.open("https://google.com", "_blank"),
                custom_alert: () => alert("¬°Esta es una acci√≥n personalizada!"),
                demo_action_1: () => alert("Acci√≥n demo 1"),
                demo_action_2: () => alert("Acci√≥n demo 2"),
                updated_action_1: () => alert("Acci√≥n actualizada 1"),
                updated_action_2: () => alert("Acci√≥n actualizada 2"),
                new_action: () => alert("¬°Nueva acci√≥n!"),
                amazing_action: () => alert("¬°Eres incre√≠ble!")
            };
            
            window.decisionChatWidget.updateActions(newActions);
            showStatus("‚úÖ Acciones personalizadas agregadas");
        }

        function loadFromAPI() {
            // Simular carga desde API
            showStatus("üîÑ Simulando carga desde API...");
            
            setTimeout(() => {
                const mockAPIData = {
                    start: {
                        message: "¬°Datos cargados desde API!",
                        options: [
                            { text: "Opci√≥n desde API 1", action: "api_action_1" },
                            { text: "Opci√≥n desde API 2", action: "api_action_2" }
                        ]
                    }
                };
                
                window.decisionChatWidget.updateTree(mockAPIData);
                window.decisionChatWidget.updateActions({
                    api_action_1: () => alert("Acci√≥n desde API 1"),
                    api_action_2: () => alert("Acci√≥n desde API 2")
                });
                
                showStatus("‚úÖ Datos cargados desde API");
            }, 1000);
        }

        function showCurrentTree() {
            const tree = window.decisionChatWidget.getTree();
            console.log("√Årbol actual:", tree);
            showStatus("‚úÖ √Årbol actual mostrado en consola (F12)");
        }

        function resetToDefault() {
            window.decisionChatWidget.updateTree(window.decisionChatConfig.initialTree);
            showStatus("‚úÖ Widget reseteado a configuraci√≥n inicial");
        }

        function showStatus(message) {
            const statusDiv = document.getElementById('status');
            statusDiv.innerHTML = `<div class="status ${message.includes('‚ùå') ? 'error' : 'success'}">${message}</div>`;
            
            setTimeout(() => {
                statusDiv.innerHTML = '';
            }, 3000);
        }

        // Mostrar estado inicial
        setTimeout(() => {
            showStatus("‚úÖ Widget cargado y listo para usar");
        }, 1000);
    </script>
</body>
</html> 